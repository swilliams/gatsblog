{"data":{"site":{"siteMetadata":{"title":"A Blog","author":"Scott Williams"}},"markdownRemark":{"id":"122104c9-23d0-5e2b-b230-be21e7a14b80","excerpt":"I’ve been noodling with an idea for a  watchOS 2  app. It involves  Connectivity  - transferring files from the Watch to its paired iOS device. The WWDC…","html":"<p>I’ve been noodling with an idea for a <a href=\"https://developer.apple.com/watchos/pre-release/\">watchOS 2</a> app. It involves <a href=\"https://developer.apple.com/library/prerelease/watchos/documentation/WatchConnectivity/Reference/WatchConnectivity_framework/index.html#//apple_ref/doc/uid/TP40015269\">Connectivity</a> - transferring files from the Watch to its paired iOS device. The WWDC sessions are very good, but I ran into a couple of snags with the framework. I had <a href=\"https://twitter.com/swilliams/status/616671359557599232\">tweeted something that I thought was a bug</a>, but on closer inspection of the docs it actually wasn’t. I <a href=\"https://twitter.com/swilliams/status/616673013417803776\">tweeted another message stating as much</a>, but it hasn’t gotten the notice that the original did.<sup id=\"fnref:1\"><a href=\"#fn:1\" rel=\"footnote\">1</a></sup> Anyways, here’s what I learned.</p>\n<p><em>[ed: This is with iOS 9, watchOS 2, and Xcode 7, all in beta 2. Stuff might change.]</em></p>\n<h2 id=\"you-can-run-both-simulators-at-once\"><a href=\"#you-can-run-both-simulators-at-once\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>You can run both simulators at once</h2>\n<p>But it’s not obvious. First, run the watchOS simulator. In the scheme control, it’s the ”[App Name] WatchKit App” scheme, which has both the iPhone and Apple Watch available (for example, “iPhone 6 + Apple Watch - 38mm”), and run it. </p>\n<figure class=\"center\">\n    \n  <a class=\"gatsby-resp-image-link\" href=\"/static/37fa7d7de16c15b0207a84736555cbde/0a02c/conn-iphone-6-and-watch.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n  \n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block;  max-width: 424px; margin-left: auto; margin-right: auto;\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 7.547169811320755%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsSAAALEgHS3X78AAAAgElEQVQI1x2Ouw7CMBRD+/+/BQtiQELkIXKbR5OmlKrtxHyIMnixjy0Pda5MUyaGSK0LpRRSjMxlZkqZc1t51B83Hfi0LDf22He29UtOqXGF4APncbC0/uDeDmssRhucky5jDCLSvSCOq8pc7k+S91hrSW3IjyPqpTqnle4nREb+AJuQUb/RYocAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\">\n      <img class=\"gatsby-resp-image-image\" style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\" alt=\"Xcode Scheme for iPhone6 and Watch\" title=\"\" src=\"/static/37fa7d7de16c15b0207a84736555cbde/0a02c/conn-iphone-6-and-watch.png\" srcset=\"/static/37fa7d7de16c15b0207a84736555cbde/2b27a/conn-iphone-6-and-watch.png 148w,\n/static/37fa7d7de16c15b0207a84736555cbde/dd8bf/conn-iphone-6-and-watch.png 295w,\n/static/37fa7d7de16c15b0207a84736555cbde/0a02c/conn-iphone-6-and-watch.png 424w\" sizes=\"(max-width: 424px) 100vw, 424px\">\n    </span>\n  </span>\n  \n  </a>\n    \n</figure>\n<p>When it’s running, change the scheme (without stopping the simulator) to the normal iPhone scheme. In this case ”[App Name] > iPhone 6”. </p>\n<figure class=\"center\">\n    \n  <a class=\"gatsby-resp-image-link\" href=\"/static/28d424316392f0419f8b346122c7dba6/8cc2a/conn-iphone-6.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n  \n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block;  max-width: 224px; margin-left: auto; margin-right: auto;\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 14.732142857142858%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsSAAALEgHS3X78AAAAvElEQVQI1z2NQU7DMBBFc3+JS3AAdixgy4pFlRSljR1PXFOFpkEidpxYZfdws2DxNH/+G2mKn2ki+kiYZ2KMrOtKSus2l2X5J6XEPGcfA+l2w3uf+7j1dx9CYBxHirB4mtdHXLlDi0V0i2pUpkEdNfVHzb6sOBw00/jFk/7l4bnEKkVV1bSNRlrDdRgYMoVzHdbsOYvQWYs7OTrpkLzfszFmy5KfXfoz7+03L287rpeBU/ZihE/n6Pt+u/0DVinauRLdmuUAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;\">\n      <img class=\"gatsby-resp-image-image\" style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\" alt=\"Xcode Scheme for iPhone6 and Watch\" title=\"\" src=\"/static/28d424316392f0419f8b346122c7dba6/8cc2a/conn-iphone-6.png\" srcset=\"/static/28d424316392f0419f8b346122c7dba6/61446/conn-iphone-6.png 148w,\n/static/28d424316392f0419f8b346122c7dba6/8cc2a/conn-iphone-6.png 224w\" sizes=\"(max-width: 224px) 100vw, 224px\">\n    </span>\n  </span>\n  \n  </a>\n    \n</figure>\n<p>Now, run this scheme <em>without</em> compiling: hold down ⌘ and click the Run button. The iOS app will now be running in the simulator. Sometimes the watch app will close, but you can open it back up again.</p>\n<p>The console and breakpoints may get a little squirrelly, so you probably won’t be able to depend on them so well.</p>\n<h2 id=\"wcsessiondelegate\"><a href=\"#wcsessiondelegate\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WCSessionDelegate</h2>\n<p>Connectivity has one main delegate to implement: <a href=\"https://developer.apple.com/library/prerelease/watchos/documentation/WatchConnectivity/Reference/WCSessionDelegate_protocol/\"><code class=\"language-text\">WCSessionDelegate</code></a>. This can be implemented on <em>both</em> the iOS and watchOS apps, and different behavior will happen. For example, when you transfer a file, the <strong>receiver</strong> will need to implement <code class=\"language-text\">session:didReceiveFile:</code>. If you want to receive some kind of notification that the file was sent the <strong>sender</strong> needs to implement <code class=\"language-text\">session:didFinishFileTransfer:error:</code>. </p>\n<p>This seemed counter-intuitive to me at first, but on further reflection, it makes sense. I do wish the docs more clearly illustrated this though.</p>\n<h2 id=\"youre-in-the-background\"><a href=\"#youre-in-the-background\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>You’re in the background</h2>\n<p>Don’t forget that your iOS app is <strong>not</strong> guaranteed to be running when these notifications come in. And they will come in on a background queue too, so don’t immediately try to update the UI without getting over to the main queue first.</p>\n<h2 id=\"demo\"><a href=\"#demo\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Demo</h2>\n<p>I created a simple demo app to illustrate all of this. <a href=\"https://github.com/swilliams/watchkit-connectivity-demo\">It’s up on GitHub</a>. Take a look at the <code class=\"language-text\">AppDelegate</code> for the iOS app, the <code class=\"language-text\">ExtensionDelegate</code> and <code class=\"language-text\">InterfaceController</code> in the watchOS extension target. This demo was thrown together quickly without regard for best practices, blah blah blah.</p>\n<div class=\"footnotes\">\n  <ol>\n    <li class=\"footnote\" id=\"fn:1\">\n  <p>Such is the nature of Twitter, alas.</p>\n</li>\n  </ol>\n</div>","frontmatter":{"title":"WatchKit Connectivity and File Transfers","date":"July 02, 2015"}}},"pageContext":{"slug":"/2015/07/02/watchkit-connectivity-and-file-transfers/","previous":{"fields":{"slug":"/2015/06/30/basic-github-workflow-for-collaboration/"},"frontmatter":{"title":"Basic GitHub Workflow For Collaboration"}},"next":{"fields":{"slug":"/2015/07/24/great-moments-in-customer-service/"},"frontmatter":{"title":"Great Moments in Customer Service"}}}}